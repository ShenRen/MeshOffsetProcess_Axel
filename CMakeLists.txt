###############################################################################
# MODULE       : CMakeList.txt
# DESCRIPTION  : Configuration file for cmake
# GENERATED BY : mourrain
#         WITH : mmxmake 
###############################################################################
cmake_minimum_required (VERSION 2.6)

PROJECT (MyPkg)

set (PROJECT_VERSION 0.1)

string (TOUPPER ${PROJECT_NAME} PKG_NAME)
string (TOLOWER ${PROJECT_NAME} LIB_NAME)

set (${PKG_NAME}_PACKAGE ${PROJECT_NAME}        )
set (${PKG_NAME}_PREFIX  ${CMAKE_INSTALL_PREFIX})
set (${PKG_NAME}_SOURCE_DIR  ${CMAKE_SOURCE_DIR})

set (CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} ${CMAKE_BINARY_DIR}/cmake/)

######################################################################
# Subdirectory src
######################################################################
option (${PKG_NAME}_SRC " " ON)
if (${PKG_NAME}_SRC)
  message ("   using subdirectory src")
  add_subdirectory (src)
endif (${PKG_NAME}_SRC)

######################################################################
# Subdirectory axl
######################################################################
option (${PKG_NAME}_AXL " " ON)
if (${PKG_NAME}_AXL)
  message ("   using subdirectory axl")
  add_subdirectory (axl)
endif (${PKG_NAME}_AXL)

######################################################################
# Subdirectory doc
######################################################################
option (${PKG_NAME}_DOC " " OFF)
if (${PKG_NAME}_DOC)
  message ("   using subdirectory doc")
  add_subdirectory (doc)
endif (${PKG_NAME}_DOC)

######################################################################
# Packaging
######################################################################
  set(CPACK_PACKAGE_VENDOR "MyCompany")
  #set(CPACK_PACKAGE_DESCRIPTION_FILE ${CMAKE_CURRENT_SOURCE_DIR}/README.txt)
  set(CPACK_PACKAGE_DESCRIPTION_SUMMARY ${PROJECT_NAME})
  set(CPACK_PACKAGE_DESCRIPTION ${PROJECT_NAME})
 # set(CPACK_RESOURCE_FILE_LICENSE ${CMAKE_CURRENT_SOURCE_DIR}/COPYING.txt)

  set (CPACK_PACKAGE_VERSION ${PROJECT_AXEL_VERSION})
  set (CPACK_PACKAGE_CONTACT "contact@mycompany.com")
  set (CPACK_PACKAGE_SUMMARY ${PROJECT_NAME})
  set (CPACK_PACKAGE_DEFAULT_LOCATION "${PROJECT_SOURCE_DIR}")
  set (CPACK_SOURCE_INSTALLED_DIRECTORIES "${PROJECT_SOURCE_DIR};.")
  set (CPACK_BINARY_STGZ "ON")
  set (CPACK_BINARY_TBZ2 "OFF")
  set (CPACK_BINARY_TGZ "ON")
  set (CPACK_BINARY_TZ "ON")
  set (CPACK_GENERATOR "")
  set (CPACK_SOURCE_GENERATOR "TGZ;STGZ")

  if( BUILD_FOR_RELEASE)
  set (CPACK_INSTALL_PREFIX "/usr/local")
  endif ( BUILD_FOR_RELEASE)

if(WIN32)
    set (CPACK_PACKAGING_INSTALL_PREFIX "")
    set (CPACK_PACKAGE_INSTALL_DIRECTORY "axel-sdk 2.2.0")
    set (CPACK_PACKAGE_INSTALL_REGISTRY_KEY ${PROJECT_NAME}-${PROJECT_AXEL_VERSION})
    set (CPACK_GENERATOR "NSIS")
    set (CPACK_NSIS_DISPLAY_NAME "${CPACK_PACKAGE_INSTALL_DIRECTORY} MyPlugin")
    #set(CPACK_NSIS_MODIFY_PATH ON) # Choice to add prog dir to the system PATH
    set (CPACK_PACKAGE_FILE_NAME MyPlugin-${PROJECT_AXEL_VERSION}-${PROJECT_VERSION}-win32-x86)
endif (WIN32)

if(UNIX AND NOT APPLE)
  if( BUILD_FOR_RELEASE)
        set (CPACK_PACKAGING_INSTALL_PREFIX  "/usr/local")
  endif( BUILD_FOR_RELEASE)

  set (CPACK_RPM_PACKAGE_DEBUG     0)
  set (CPACK_PACKAGE_FILE_NAME MyPlugin-${PROJECT_AXEL_VERSION}-${PROJECT_VERSION}-fc16.x86_64)
  set (CPACK_GENERATOR "${CPACK_GENERATOR};RPM")
endif(UNIX AND NOT APPLE)

set(CPACK_SOURCE_PACKAGE_FILE_NAME "${PROJECT_NAME}-${PROJECT_VERSION}-src")

include (CPack)
